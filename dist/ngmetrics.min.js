!function(a){"use strict";var b=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3];c+=(d&e|~d&f)+b[0]-680876936|0,c=(c<<7|c>>>25)+d|0,f+=(c&d|~c&e)+b[1]-389564586|0,f=(f<<12|f>>>20)+c|0,e+=(f&c|~f&d)+b[2]+606105819|0,e=(e<<17|e>>>15)+f|0,d+=(e&f|~e&c)+b[3]-1044525330|0,d=(d<<22|d>>>10)+e|0,c+=(d&e|~d&f)+b[4]-176418897|0,c=(c<<7|c>>>25)+d|0,f+=(c&d|~c&e)+b[5]+1200080426|0,f=(f<<12|f>>>20)+c|0,e+=(f&c|~f&d)+b[6]-1473231341|0,e=(e<<17|e>>>15)+f|0,d+=(e&f|~e&c)+b[7]-45705983|0,d=(d<<22|d>>>10)+e|0,c+=(d&e|~d&f)+b[8]+1770035416|0,c=(c<<7|c>>>25)+d|0,f+=(c&d|~c&e)+b[9]-1958414417|0,f=(f<<12|f>>>20)+c|0,e+=(f&c|~f&d)+b[10]-42063|0,e=(e<<17|e>>>15)+f|0,d+=(e&f|~e&c)+b[11]-1990404162|0,d=(d<<22|d>>>10)+e|0,c+=(d&e|~d&f)+b[12]+1804603682|0,c=(c<<7|c>>>25)+d|0,f+=(c&d|~c&e)+b[13]-40341101|0,f=(f<<12|f>>>20)+c|0,e+=(f&c|~f&d)+b[14]-1502002290|0,e=(e<<17|e>>>15)+f|0,d+=(e&f|~e&c)+b[15]+1236535329|0,d=(d<<22|d>>>10)+e|0,c+=(d&f|e&~f)+b[1]-165796510|0,c=(c<<5|c>>>27)+d|0,f+=(c&e|d&~e)+b[6]-1069501632|0,f=(f<<9|f>>>23)+c|0,e+=(f&d|c&~d)+b[11]+643717713|0,e=(e<<14|e>>>18)+f|0,d+=(e&c|f&~c)+b[0]-373897302|0,d=(d<<20|d>>>12)+e|0,c+=(d&f|e&~f)+b[5]-701558691|0,c=(c<<5|c>>>27)+d|0,f+=(c&e|d&~e)+b[10]+38016083|0,f=(f<<9|f>>>23)+c|0,e+=(f&d|c&~d)+b[15]-660478335|0,e=(e<<14|e>>>18)+f|0,d+=(e&c|f&~c)+b[4]-405537848|0,d=(d<<20|d>>>12)+e|0,c+=(d&f|e&~f)+b[9]+568446438|0,c=(c<<5|c>>>27)+d|0,f+=(c&e|d&~e)+b[14]-1019803690|0,f=(f<<9|f>>>23)+c|0,e+=(f&d|c&~d)+b[3]-187363961|0,e=(e<<14|e>>>18)+f|0,d+=(e&c|f&~c)+b[8]+1163531501|0,d=(d<<20|d>>>12)+e|0,c+=(d&f|e&~f)+b[13]-1444681467|0,c=(c<<5|c>>>27)+d|0,f+=(c&e|d&~e)+b[2]-51403784|0,f=(f<<9|f>>>23)+c|0,e+=(f&d|c&~d)+b[7]+1735328473|0,e=(e<<14|e>>>18)+f|0,d+=(e&c|f&~c)+b[12]-1926607734|0,d=(d<<20|d>>>12)+e|0,c+=(d^e^f)+b[5]-378558|0,c=(c<<4|c>>>28)+d|0,f+=(c^d^e)+b[8]-2022574463|0,f=(f<<11|f>>>21)+c|0,e+=(f^c^d)+b[11]+1839030562|0,e=(e<<16|e>>>16)+f|0,d+=(e^f^c)+b[14]-35309556|0,d=(d<<23|d>>>9)+e|0,c+=(d^e^f)+b[1]-1530992060|0,c=(c<<4|c>>>28)+d|0,f+=(c^d^e)+b[4]+1272893353|0,f=(f<<11|f>>>21)+c|0,e+=(f^c^d)+b[7]-155497632|0,e=(e<<16|e>>>16)+f|0,d+=(e^f^c)+b[10]-1094730640|0,d=(d<<23|d>>>9)+e|0,c+=(d^e^f)+b[13]+681279174|0,c=(c<<4|c>>>28)+d|0,f+=(c^d^e)+b[0]-358537222|0,f=(f<<11|f>>>21)+c|0,e+=(f^c^d)+b[3]-722521979|0,e=(e<<16|e>>>16)+f|0,d+=(e^f^c)+b[6]+76029189|0,d=(d<<23|d>>>9)+e|0,c+=(d^e^f)+b[9]-640364487|0,c=(c<<4|c>>>28)+d|0,f+=(c^d^e)+b[12]-421815835|0,f=(f<<11|f>>>21)+c|0,e+=(f^c^d)+b[15]+530742520|0,e=(e<<16|e>>>16)+f|0,d+=(e^f^c)+b[2]-995338651|0,d=(d<<23|d>>>9)+e|0,c+=(e^(d|~f))+b[0]-198630844|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[7]+1126891415|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[14]-1416354905|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[5]-57434055|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[12]+1700485571|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[3]-1894986606|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[10]-1051523|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[1]-2054922799|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[8]+1873313359|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[15]-30611744|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[6]-1560198380|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[13]+1309151649|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[4]-145523070|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[11]-1120210379|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[2]+718787259|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[9]-343485551|0,d=(d<<21|d>>>11)+e|0,a[0]=c+a[0]|0,a[1]=d+a[1]|0,a[2]=e+a[2]|0,a[3]=f+a[3]|0},c="0123456789abcdef",d=[],e=function(a){for(var b,e,f,g=c,h=d,i=0;4>i;i++)for(e=8*i,b=a[i],f=0;8>f;f+=2)h[e+1+f]=g.charAt(15&b),b>>>=4,h[e+0+f]=g.charAt(15&b),b>>>=4;return h.join("")},f=function(){this._dataLength=0,this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._bufferLength=0,this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()},g=new Int32Array([1732584193,-271733879,-1732584194,271733878]),h=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);f.prototype.appendStr=function(a){for(var c,d=this._buffer8,e=this._buffer32,f=this._bufferLength,g=0;g<a.length;g++){if(c=a.charCodeAt(g),128>c)d[f++]=c;else if(2048>c)d[f++]=(c>>>6)+192,d[f++]=63&c|128;else if(55296>c||c>56319)d[f++]=(c>>>12)+224,d[f++]=c>>>6&63|128,d[f++]=63&c|128;else{if(c=1024*(c-55296)+(a.charCodeAt(++g)-56320)+65536,c>1114111)throw"Unicode standard supports code points up to U+10FFFF";d[f++]=(c>>>18)+240,d[f++]=c>>>12&63|128,d[f++]=c>>>6&63|128,d[f++]=63&c|128}f>=64&&(this._dataLength+=64,b(this._state,e),f-=64,e[0]=e[16])}return this._bufferLength=f,this},f.prototype.appendAsciiStr=function(a){for(var c,d=this._buffer8,e=this._buffer32,f=this._bufferLength,g=0;;){for(c=Math.min(a.length-g,64-f);c--;)d[f++]=a.charCodeAt(g++);if(64>f)break;this._dataLength+=64,b(this._state,e),f=0}return this._bufferLength=f,this},f.prototype.appendByteArray=function(a){for(var c,d=this._buffer8,e=this._buffer32,f=this._bufferLength,g=0;;){for(c=Math.min(a.length-g,64-f);c--;)d[f++]=a[g++];if(64>f)break;this._dataLength+=64,b(this._state,e),f=0}return this._bufferLength=f,this},f.prototype.start=function(){return this._dataLength=0,this._bufferLength=0,this._state.set(g),this},f.prototype.end=function(a){var c=this._bufferLength;this._dataLength+=c;var d=this._buffer8;d[c]=128,d[c+1]=d[c+2]=d[c+3]=0;var f=this._buffer32,g=(c>>2)+1;f.set(h.subarray(g),g),c>55&&(b(this._state,f),f.set(h));var i=8*this._dataLength;if(4294967295>=i)f[14]=i;else{var j=i.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(j[2],16),l=parseInt(j[1],16)||0;f[14]=k,f[15]=l}return b(this._state,f),a?this._state:e(this._state)};var i=new f;f.hashStr=function(a,b){return i.start().appendStr(a).end(b)},f.hashAsciiStr=function(a,b){return i.start().appendAsciiStr(a).end(b)};var j={getItem:function(a){return a?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null},setItem:function(a,b,c,d,e,f){if(!a||/^(?:expires|max\-age|path|domain|secure)$/i.test(a))return!1;var g="";if(c)switch(c.constructor){case Number:g=c===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+c;break;case String:g="; expires="+c;break;case Date:g="; expires="+c.toUTCString()}return document.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+g+(e?"; domain="+e:"")+(d?"; path="+d:"")+(f?"; secure":""),!0},removeItem:function(a,b,c){return this.hasItem(a)?(document.cookie=encodeURIComponent(a)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(c?"; domain="+c:"")+(b?"; path="+b:""),!0):!1},hasItem:function(a){return a?new RegExp("(?:^|;\\s*)"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie):!1},keys:function(){for(var a=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),b=a.length,c=0;b>c;c++)a[c]=decodeURIComponent(a[c]);return a}},k=function(a){this.id=a,this.cycles=0,this.avg=0,this.max=0,this.stack=""},l=function(a,b){this.$injector=a,b?this.getCurrentPath=b:this.detectMethod()};l.prototype.getCurrentUrl=l.prototype.getCurrentPath=function(){return[window.location.pathname,window.location.search,window.location.hash].join("")},l.prototype.detectMethod=function(){var a=!1;try{var b=this.$injector.get("$state");this.getCurrentPath=function(){return b.$current&&b.$current.url.source},a=!0}catch(c){}if(!a)try{var d=this.$injector.get("$route");this.getCurrentPath=function(){return d.current&&d.current.$$route.originalPath}}catch(c){}};var m=function(a){this.directivesQueue=a,this.directivesQueue.forEach(function(a){this.decorateDirective(a)}.bind(this)),this.directivesQueue.push=this.decorateDirective.bind(this),this.currentStats=[]};m.prototype.enabled=!1,m.prototype.enable=function(){this.enabled=!0},m.prototype.disable=function(){this.enabled=!1},m.prototype.decorateDirective=function(a){var b=this,c=a.module,d=a.dirName;c.config(["$provide",function(a){a.decorator(d+"Directive",["$delegate",function(a){if(a[0]&&a[0].compile){var c=a[0].compile;a[0].compile=function(){var e=c.apply(a[0],arguments);if("function"==typeof e){var f={link:e};b.patchFunction(f,"link",d),e=f.link}else b.patchFunction(e,"link",d),b.patchFunction(e,"pre",d),b.patchFunction(e,"post",d);return e}}return b.patchFunction(a[0],"compile",d),b.patchFunction(a[0],"link",d),a}])}])},m.prototype.currentStats=[],m.prototype.flush=function(){var a=this.currentStats;return this.currentStats=[],a},m.prototype.addStat=function(a,b,c,d){this.currentStats.push({dn:a,fn:b,el:o.getPath(c),du:d})},m.prototype.patchFunction=function(a,b,c){var d=this;if(a[b]){var e=a[b];a[b]=function(f,g){if(!d.enabled)return e.apply(a,arguments);"compile"===b&&(g=f,f=null);var h=o.perf(),i=e.apply(a,arguments),j=o.perf()-h;return d.addStat(c,b,g,j),i}}};var n=function(a,b){this.route=a,b&&(this.events=b),this.handleEvent=this.handleEvent.bind(this),this.records=[]};n.prototype.records=null,n.prototype.cutoffDelay=1e3,n.prototype.events=["click","keydown","submit","mousein"],n.prototype.settled=!0,n.prototype.currentTimeout=0,n.prototype.currentEvent={},n.prototype.currentPath="",n.prototype.currentUrl="",n.prototype.eventTimestamp=0,n.prototype.digests=[],n.prototype.totalDigest=0,n.prototype.attachEventListeners=function(){var a=this;this.events.forEach(function(b){document.addEventListener(b,a.handleEvent,!0)})},n.prototype.detachEventListeners=function(){var a=this;this.events.forEach(function(b){document.removeEventListener(b,a.handleEvent)})},n.prototype.handleEvent=function(a){this.settled||this.settle(),this.currentEvent=a,this.settled=!1,this.eventTimestamp=Date.now(),this.digests=[],this.totalDigest=0,this.currentPath=this.route.getCurrentPath(),this.currentUrl=this.route.getCurrentUrl(),this.scheduleSettle()},n.prototype.scheduleSettle=function(){this.cancelScheduledSettle(),this.settled||(this.currentTimeout=setTimeout(this.settle.bind(this),this.cutoffDelay))},n.prototype.cancelScheduledSettle=function(){clearTimeout(this.currentTimeout),this.currentTimeout=null},n.prototype.addDigestTime=function(a,b){-1===this.digests.indexOf(b)&&this.digests.push(b),this.totalDigest+=a,this.scheduleSettle()},n.prototype.settle=function(){if(this.settled=!0,0!==this.totalDigest){var a={path:this.currentPath,url:this.currentUrl,digests:this.digests,totalDigest:this.totalDigest,eventName:this.currentEvent.type,htmlElement:o.getPath(this.currentEvent.target)};this.records.push(a)}},n.prototype.flush=function(){var a=this.records;return this.records=[],a};var o={};o.previousElementSibling=function(a){if("undefined"!==a.previousElementSibling)return a.previousElementSibling;for(a=a.previousSibling;a;){if(1===a.nodeType)return a;a=a.previousSibling}},o.getPath=function(a){if(a&&a.length&&(a=a[0]),!(a instanceof HTMLElement))return!1;for(var b=[];a&&a.nodeType===Node.ELEMENT_NODE;){var c=a.nodeName;if(a.id)c+="#"+a.id;else{for(var d=a,e=[];null!==d&&d.nodeType===Node.ELEMENT_NODE;)e.unshift(d.nodeName),d=o.previousElementSibling(d);"HTML"!==e[0]&&(e[0]=e[0]+":first-child"),c=e.join(" + ")}b.unshift(c),a=a.parentNode}return b.join(" > ")},performance&&performance.now?o.perf=function(){return performance.now()}:o.perf=function(){return Date.now()};var p=function(a,b){var c=this;window.m=this,this.orig={},this.digests={},this.routeStats={},this.finalFlushed=!1,this.directivesMetrics=new this.Directive(b),this.decorateMap={$rootScope:{$digest:function(a,b){var d=c.MD5.hashStr(b),e=c.getDigest(d,b);this.$$ngMetricsDigestId=d,c.rsMetrics.cancelScheduledSettle();var f=Date.now();a.call(this);var g=Date.now()-f;g>e.max&&(e.max=g),e.avg=(e.avg*e.cycles+g)/(e.cycles+1),e.cycles++,c.rsMetrics.addDigestTime(g,d);var h=c.getCurrentRouteStat();-1===h.digests.indexOf(d)&&h.digests.push(d),g>h.maxDigest&&(h.maxDigest=g,h.maxDigestId=d),h.totalDigest+=g}}};for(var d in this.decorateMap)this.decorateMap.hasOwnProperty(d)&&a.decorator(d,["$delegate",function(a){var b=c.decorateMap[d],e=Object.getPrototypeOf(a);c.orig[d]={};for(var f in b)if(b.hasOwnProperty(f)){var g=c.orig[d][f]=e[f];e[f]=function(){var a=(new Error).stack;if(c.enabled){var d=Array.prototype.slice.call(arguments);d.unshift(g,a),b[f].apply(this,d)}else g.apply(this,arguments)}}return a}])};p.prototype.enabled=!1,p.prototype.flushInterval=null,p.prototype.cookieName="__ngmguid",p.prototype.metricsServer="app.ngmetrics.com",p.prototype.appId=null,p.prototype.getDigest=function(a,b){var c=this.digests[a];return c||(c=this.digests[a]=new this.Digest(a),c.stack=b),c},p.prototype.getCurrentRouteStat=function(){var a=this.route.getCurrentPath()||"";return this.routeStats[a]||(this.routeStats[a]={path:a,url:this.route.getCurrentUrl(),digests:[],maxDigest:0,maxDigestId:"",totalDigest:0}),this.routeStats[a]},p.prototype.getEndpointUrl=function(){return"http://"+this.metricsServer+"/api/data/log?key="+this.appId+"&__c="+Date.now()},p.prototype.flushCollectedMetrics=function(a){if(0!==Object.keys(this.digests).length){var b={guid:this.getGuid(),digests:[],routes:[],rs:this.rsMetrics.flush(),dt:this.directivesMetrics.flush()};Object.keys(this.digests).forEach(function(a){b.digests.push(this.digests[a])}.bind(this)),this.digests={},Object.keys(this.routeStats).forEach(function(a){b.routes.push(this.routeStats[a])}.bind(this)),this.routeStats={};var c=JSON.stringify(b),d=this.getXhr();d.open("POST",this.getEndpointUrl(),!a),d.setRequestHeader("Content-type","application/json"),d.send(c)}},p.prototype.getXhr=function(){return this.xhr||(this.xhr=new XMLHttpRequest),this.xhr},p.prototype.init=function(){},p.prototype.finalFlush=function(){this.finalFlushed||(this.finalFlushed=!0,this.flushCollectedMetrics())},p.prototype.enable=function(){return null==this.appId?void console.warn("ngMetrics requires appId to be set before enabling"):(this.flushInterval=setInterval(this.flushCollectedMetrics.bind(this),6e4),this.rsMetrics.attachEventListeners(),this.directivesMetrics.enable(),this.enabled=!0,this.finalFlushed=!1,angular.element(window).on("beforeunload",this.finalFlush),void angular.element(window).on("unload",this.finalFlush))},p.prototype.disable=function(){this.flushInterval&&(clearInterval(this.flushInterval),this.flushInterval=null),this.rsMetrics.detachEventListeners(),this.directivesMetrics.disable(),this.enabled=!1,angular.element(window).off("beforeunload",this.finalFlush),angular.element(window).off("unload",this.finalFlush)},p.prototype.getGuid=function(){if(this.docCookies.hasItem(this.cookieName))return this.docCookies.getItem(this.cookieName);var a=this.generateGuid();return this.docCookies.setItem(this.cookieName,a,1/0,"/"),a},p.prototype.generateGuid=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},p.prototype.$get=["$parse","$injector","$rootScope",function(a,b,c){return this.$parse=a,this.$injector=b,this.$rootScope=c,this.route=new l(this.$injector),this.rsMetrics=new n(this.route),this.finalFlush=this.finalFlush.bind(this),this}],p.prototype.docCookies=j,p.prototype.Digest=k,p.prototype.MD5=f,p.prototype.Directive=m;var q=[],r=[],s=angular.module("ngMetrics",[]);s.provider("ngMetrics",["$provide",function(a){return new p(a,r)}]);var t=angular.module;angular.module=function(a,b){var c=t.apply(angular,arguments);if(!b)return c;var d=c.directive;return c.directive=function(a){var b=d.apply(c,arguments);return q.indexOf(a)>-1?b:(q.push(a),r.push({module:c,dirName:a}),b)},c}}(this);